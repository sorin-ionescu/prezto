#
# Highlights diff output.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

function diff {
  if zstyle -t ':prezto:module:utility:diff' color; then
    if (( $+commands[colordiff] )); then
      command diff --unified "$@" | colordiff --difftype diffu
    elif (( $+commands[git] )); then
      local diffr=0
      for x; do
        if [ "$x" = '-r' ]; then diffr=1; fi
      done
      if [ $diffr -eq 0 ]; then
        git --no-pager diff --color=auto --no-ext-diff --no-index "$@"
      else 
        command diff --unified "$@"
      fi
    else
      command diff --unified "$@"
    fi
  else
    command diff --unified "$@"
  fi
}

diff "$@"
